Try to improve the performance to the limit.
Let me know if you have any suggestions: better algorithm or implementation, etc.
